<!doctype html><html lang=en><meta name=viewport content="width=device-width,initial-scale=1"><title></title><link rel=icon href=/if.png><link rel=stylesheet href=/style.css><link rel=alternate href=/blog/feed.xml type=application/atom+xml title="Isaac Freund's Blog"><link rel=alternate href=/poetry/feed.xml type=application/atom+xml title="Isaac Freund's Poetry"><link rel=me href=https://hachyderm.io/@ifreund><header><nav><input type=checkbox id=toggle><div class=nav-bar><div class=nav-home><a href=/><svg viewBox="0 0 5 5" shape-rendering="crispEdges"><rect x="0" y="0" width="1" height="1"/><rect x="0" y="2" width="1" height="3"/><path d="M2 0h3v1H3v1h2v1H3v2H2V0z"/><rect x="4" y="4" width="1" height="1"/></svg></a></div><div class=menu><label for=toggle class=menu-button><svg class="menu-icon" viewBox="0 0 5 5" shape-rendering="crispEdges"><rect x="0" y="0" width="5" height="1"/><rect x="0" y="2" width="5" height="1"/><rect x="0" y="4" width="5" height="1"/></svg>
<svg class="close-icon" viewBox="0 0 5 5" shape-rendering="crispEdges"><line x1="0" y1="0" x2="5" y2="5"/><line x1="0" y1="5" x2="5" y2="0"/></svg></label></div></div></div><div class=nav-items><a href=/about>about</a>
<a href=/blog>blog</a>
<a href=/software>software</a>
<a href=/poetry>poetry</a>
<a href=/consulting>consulting</a></div></nav></header><main class="wayland-protocol river-xkb-config-v1"><div class=title><h1>river-xkb-config-v1</h1><p class=summary>configure xkbcommon keyboard state</div><div class=content><div class=description><p>This protocol allow a client to set the xkbcommon keymap of individual
keyboard input devices. It also allows switching between the layouts of a
keymap and toggling capslock/numlock state.<p>The key words "must", "must not", "required", "shall", "shall not",
"should", "should not", "recommended", "may", and "optional" in this
document are to be interpreted as described in IETF RFC 2119.</div><div class=interface-head><div class=row><div><h2><a id=river_xkb_config_v1 href=#river_xkb_config_v1>river_xkb_config_v1</a></h2><p class=summary>xkb config global interface</div><div><b>Interface</b><br>Version 1</div></div></div><div class=description><p>Global interface for configuring xkb devices.<p>This global should only be advertised if <b><a href=/docs/wayland/river-input-management-v1/#river_input_manager_v1>river_input_manager_v1</a></b> is
advertised as well.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.stop href=#river_xkb_config_v1.stop>river_xkb_config_v1.stop</a></h3><p class=summary>stop sending events</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>This request indicates that the client no longer wishes to receive
events on this object.<p>The Wayland protocol is asynchronous, which means the server may send
further events until the stop request is processed. The client must wait
for a <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_config_v1.finished>river_xkb_config_v1.finished</a></b> event before destroying this object.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.destroy href=#river_xkb_config_v1.destroy>river_xkb_config_v1.destroy</a></h3><p class=summary>destroy the river_xkb_config_v1 object</div><div><b>Destructor
Request</b><br>Since Version 1</div></div></div><div class=description><p>This request should be called after the finished event has been received
to complete destruction of the object.<p>It is a protocol error to make this request before the finished event
has been received.<p>If a client wishes to destroy this object it should send a
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_config_v1.stop>river_xkb_config_v1.stop</a></b> request and wait for a
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_config_v1.finished>river_xkb_config_v1.finished</a></b> event. Once the finished event is received
it is safe to destroy this object and any other objects created through
this interface.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.create_keymap href=#river_xkb_config_v1.create_keymap>river_xkb_config_v1.create_keymap</a></h3><p class=summary>create a keymap object</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>The server must be able to mmap the fd with MAP_PRIVATE.
The server will fstat the fd to obtain the size of the keymap.
The client must not modify the contents of the fd after making this request.
The client should seal the fd with fcntl.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>id<td>new_id&lt;<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keymap_v1>river_xkb_keymap_v1</a></b>><td><p><tr><td>fd<td>fd<td><p><tr><td>format<td>uint&lt;<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_config_v1.enums.keymap_format>keymap_format</a></b>><td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.finished href=#river_xkb_config_v1.finished>river_xkb_config_v1.finished</a></h3><p class=summary>the server has finished with the object</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>This event indicates that the server will send no further events on this
object. The client should destroy the object. See
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_config_v1.destroy>river_xkb_config_v1.destroy</a></b> for more information.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.xkb_keyboard href=#river_xkb_config_v1.xkb_keyboard>river_xkb_config_v1.xkb_keyboard</a></h3><p class=summary>new xkb keyboard</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>A new xkbcommon keyboard has been created. Not every
<b><a href=/docs/wayland/river-input-management-v1/#river_input_device_v1>river_input_device_v1</a></b> is necessarily an xkbcommon keyboard as well.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>id<td>new_id&lt;<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b>><td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.enums.error href=#river_xkb_config_v1.enums.error>river_xkb_config_v1.error</a></h3><p class=summary></div><div><b>Enum</b><br>Since Version 1</div></div></div><table class=enum><thead><tr><th>Entry<th>Value<th>Since<th>Description<tbody><tr><td>invalid_destroy<td>0<td>1<td><p><tr><td>invalid_format<td>1<td>1<td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_config_v1.enums.keymap_format href=#river_xkb_config_v1.enums.keymap_format>river_xkb_config_v1.keymap_format</a></h3><p class=summary></div><div><b>Enum</b><br>Since Version 1</div></div></div><table class=enum><thead><tr><th>Entry<th>Value<th>Since<th>Description<tbody><tr><td>text_v1<td>1<td>1<td><p>XKB_KEYMAP_FORMAT_TEXT_V1<tr><td>text_v2<td>2<td>1<td><p>XKB_KEYMAP_FORMAT_TEXT_V2</table><div class=interface-head><div class=row><div><h2><a id=river_xkb_keymap_v1 href=#river_xkb_keymap_v1>river_xkb_keymap_v1</a></h2><p class=summary>xkbcommon keymap</div><div><b>Interface</b><br>Version 1</div></div></div><div class=description><p>This object is the result of attempting to create an xkbcommon keymap.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keymap_v1.destroy href=#river_xkb_keymap_v1.destroy>river_xkb_keymap_v1.destroy</a></h3><p class=summary>destroy the keymap object</div><div><b>Destructor
Request</b><br>Since Version 1</div></div></div><div class=description><p>This request indicates that the client will no longer use the keymap
object and that it may be safely destroyed.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keymap_v1.success href=#river_xkb_keymap_v1.success>river_xkb_keymap_v1.success</a></h3><p class=summary>keymap creation succeeded</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>The keymap object was successfully created and may be used with the
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1.set_keymap>river_xkb_keyboard_v1.set_keymap</a></b> request.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keymap_v1.failure href=#river_xkb_keymap_v1.failure>river_xkb_keymap_v1.failure</a></h3><p class=summary>keymap creation failed</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>The compositor failed to create a keymap from the given parameters.<p>It is a protocol error to use this keymap object with
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1.set_keymap>river_xkb_keyboard_v1.set_keymap</a></b>.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>error_msg<td>string<td><p></table><div class=interface-head><div class=row><div><h2><a id=river_xkb_keyboard_v1 href=#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></h2><p class=summary>xkbcommon keyboard device</div><div><b>Interface</b><br>Version 1</div></div></div><div class=description><p>This object represent a physical keyboard which has its configuration and
state managed by xkbcommon.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.destroy href=#river_xkb_keyboard_v1.destroy>river_xkb_keyboard_v1.destroy</a></h3><p class=summary>destroy the xkb keyboard object</div><div><b>Destructor
Request</b><br>Since Version 1</div></div></div><div class=description><p>This request indicates that the client will no longer use the keyboard
object and that it may be safely destroyed.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.set_keymap href=#river_xkb_keyboard_v1.set_keymap>river_xkb_keyboard_v1.set_keymap</a></h3><p class=summary>set the keymap</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Set the keymap for the keyboard.<p>It is a protocol error to pass a keymap object for which the
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keymap_v1.success>river_xkb_keymap_v1.success</a></b> event was not received.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>keymap<td>object&lt;<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keymap_v1>river_xkb_keymap_v1</a></b>><td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.set_layout_by_index href=#river_xkb_keyboard_v1.set_layout_by_index>river_xkb_keyboard_v1.set_layout_by_index</a></h3><p class=summary>set the active layout by index</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Set the active layout for the keyboard's keymap. Has no effect if the
layout index is out of bounds for the current keymap.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>index<td>int<td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.set_layout_by_name href=#river_xkb_keyboard_v1.set_layout_by_name>river_xkb_keyboard_v1.set_layout_by_name</a></h3><p class=summary>set the active layout by name</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Set the active layout for the keyboard's keymap. Has no effect if there
is no layout with the give name for the keyboard's keymap.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>name<td>string<td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.capslock_enable href=#river_xkb_keyboard_v1.capslock_enable>river_xkb_keyboard_v1.capslock_enable</a></h3><p class=summary>enable capslock</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Enable capslock for the keyboard.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.capslock_disable href=#river_xkb_keyboard_v1.capslock_disable>river_xkb_keyboard_v1.capslock_disable</a></h3><p class=summary>disable capslock</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Disable capslock for the keyboard.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.numlock_enable href=#river_xkb_keyboard_v1.numlock_enable>river_xkb_keyboard_v1.numlock_enable</a></h3><p class=summary>enable numlock</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Enable numlock for the keyboard.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.numlock_disable href=#river_xkb_keyboard_v1.numlock_disable>river_xkb_keyboard_v1.numlock_disable</a></h3><p class=summary>disable numlock</div><div><b>Request</b><br>Since Version 1</div></div></div><div class=description><p>Disable numlock for the keyboard.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.removed href=#river_xkb_keyboard_v1.removed>river_xkb_keyboard_v1.removed</a></h3><p class=summary>the xkb keyboard is removed</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>This event indicates that the xkb keyboard has been removed.<p>The server will send no further events on this object and ignore any
request (other than <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1.destroy>river_xkb_keyboard_v1.destroy</a></b>) made after this event
is sent. The client should destroy this object with the
<b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1.destroy>river_xkb_keyboard_v1.destroy</a></b> request to free up resources.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.input_device href=#river_xkb_keyboard_v1.input_device>river_xkb_keyboard_v1.input_device</a></h3><p class=summary>corresponding river input device</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>The <b><a href=/docs/wayland/river-input-management-v1/#river_input_device_v1>river_input_device_v1</a></b> corresponding to this xkb keyboard. This event
will always be the first event sent on the <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b> object,
and it will be sent exactly once.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>device<td>object&lt;<b><a href=/docs/wayland/river-input-management-v1/#river_input_device_v1>river_input_device_v1</a></b>><td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.layout href=#river_xkb_keyboard_v1.layout>river_xkb_keyboard_v1.layout</a></h3><p class=summary>currently active layout</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>The currently active layout index and name. The name arg may be null if
the active layout does not have a name.<p>This event is sent once when the <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b> is created and
again whenever the layout changes.</div><table class=args><thead><tr><th>Argument<th>Type<th>Description<tbody><tr><td>index<td>uint<td><p><tr><td>name<td>nullable
string<td><p></table><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.capslock_enabled href=#river_xkb_keyboard_v1.capslock_enabled>river_xkb_keyboard_v1.capslock_enabled</a></h3><p class=summary>capslock is currently enabled</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>Capslock is currently enabled for the keyboard.<p>This event is sent once when the <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b> is created and
again whenever the capslock state changes.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.capslock_disabled href=#river_xkb_keyboard_v1.capslock_disabled>river_xkb_keyboard_v1.capslock_disabled</a></h3><p class=summary>capslock is currently disabled</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>Capslock is currently disabled for the keyboard.<p>This event is sent once when the <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b> is created and
again whenever the capslock state changes.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.numlock_enabled href=#river_xkb_keyboard_v1.numlock_enabled>river_xkb_keyboard_v1.numlock_enabled</a></h3><p class=summary>numlock is currently enabled</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>Numlock is currently enabled for the keyboard.<p>This event is sent once when the <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b> is created and
again whenever the numlock state changes.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.numlock_disabled href=#river_xkb_keyboard_v1.numlock_disabled>river_xkb_keyboard_v1.numlock_disabled</a></h3><p class=summary>numlock is currently disabled</div><div><b>Event</b><br>Since Version 1</div></div></div><div class=description><p>Numlock is currently disabled for the keyboard.<p>This event is sent once when the <b><a href=/docs/wayland/river-xkb-config-v1/#river_xkb_keyboard_v1>river_xkb_keyboard_v1</a></b> is created and
again whenever the numlock state changes.</div><div class=message-head><div class=row><div><h3><a id=river_xkb_keyboard_v1.enums.error href=#river_xkb_keyboard_v1.enums.error>river_xkb_keyboard_v1.error</a></h3><p class=summary></div><div><b>Enum</b><br>Since Version 1</div></div></div><table class=enum><thead><tr><th>Entry<th>Value<th>Since<th>Description<tbody><tr><td>invalid_keymap<td>0<td>1<td><p></table><div class=interface-head><h2>Copyright</h2></div><div class=copyright><p><br>SPDX-FileCopyrightText: © 2026 Isaac Freund<br>SPDX-License-Identifier: MIT<br><br>Permission is hereby granted, free of charge, to any person obtaining a copy<br>of this software and associated documentation files (the "Software"), to<br>deal in the Software without restriction, including without limitation the<br>rights to use, copy, modify, merge, publish, distribute, sublicense, and/or<br>sell copies of the Software, and to permit persons to whom the Software is<br>furnished to do so, subject to the following conditions:<br><br>The above copyright notice and this permission notice shall be included in<br>all copies or substantial portions of the Software.<br><br>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR<br>IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,<br>FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE<br>AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER<br>LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING<br>FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS<br>IN THE SOFTWARE.<br></div></div></main><footer><span class=line>© 2021-2026 Isaac Freund,</span>
<span class=line><a href=/impressum>Impressum</a>,</span>
<span class=line>Content <a href=/CC-BY-NC-SA-4.0.txt>CC-BY-NC-SA-4.0</a>,</span>
<span class=line><a href=https://codeberg.org/ifreund/website>Source Code</a> <a href=/AGPL-3.0-only.txt>AGPL-3.0-only</a></span></footer>